<html xmlns:th="https://www.thymeleaf.org">
	<body>
		<div>
			<table>
				<tr>
					<th>Audio Source</th><th>File</th><th>Upload</th>	 <th>Play/Pause</th>		
				</tr>
				<tr th:each="source : ${storageMap}">
					<form method="POST" enctype="multipart/form-data" action="/saveFile">
					<td><input  readonly th:value="${source.mixerInfo.name}" name="outputName" type="text" /> </td> 
					<td th:text = ${source.fileName}></td>
					<td><input type="file" name="file" />
					<input type="submit" value="Upload" /></td>
					</form>
					<td><button class="playButton" th:data-mixerName="${source.mixerInfo.name}" th:data-action="play" > Play</button>
					<button class="playButton" th:data-mixerName="${source.mixerInfo.name}"  th:data-action="stop"  > Stop</button></td>
				</tr>
			</table>
		</div>
	</body>
</html>

<script>

var elements = document.getElementsByClassName("playButton");


var play = async function() {
    var attribute = encodeURIComponent(this.getAttribute("data-mixerName"));
    //alert(attribute);
    url ="/" + this.getAttribute("data-action")
    try {     
    const response = await fetch(url + "?outputName=" +  attribute, {
      method: 'get'
    });
    console.log('Completed!', response);
  } catch(err) {
    console.error(`Error: ${err}`);
  }
};

for (var i = 0; i < elements.length; i++) {
    elements[i].addEventListener('click', play, false);
}


</script>